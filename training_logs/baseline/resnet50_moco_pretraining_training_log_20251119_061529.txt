Created log file:  /content/drive/MyDrive/Colab Notebooks/7_Py_DL/FP/artifacts/moco_training_log_20251119_061529.txt
[2025-11-19 06:15:29] Creating MoCo medical image Train DataLoader... : from /content/drive/MyDrive/Colab Notebooks/7_Py_DL/FP/Data/1_final_project_updated_names_train_moco.csv
Loading dataset from: /content/drive/MyDrive/Colab Notebooks/7_Py_DL/FP/Data/1_final_project_updated_names_train_moco.csv
Training Dataset size: 49500 images
Not using pretrained weights for ResNet50: Encoder initialized randomly
[2025-11-19 06:15:29] Starting MoCo training for 70 epochs
Epoch 0/69: 100% 386/386 [06:20<00:00,  1.01it/s, loss=8.44]
[2025-11-19 06:21:50] Epoch complete 0, Loss: 8.4432
Epoch 1/69: 100% 386/386 [06:14<00:00,  1.03it/s, loss=9.15]
[2025-11-19 06:28:05] Epoch complete 1, Loss: 9.1510
Epoch 2/69: 100% 386/386 [06:19<00:00,  1.02it/s, loss=7.92]
[2025-11-19 06:34:24] Epoch complete 2, Loss: 7.9152
Epoch 3/69: 100% 386/386 [06:20<00:00,  1.01it/s, loss=7.5]
[2025-11-19 06:40:45] Epoch complete 3, Loss: 7.4953
Epoch 4/69: 100% 386/386 [06:18<00:00,  1.02it/s, loss=7.35]
[2025-11-19 06:47:03] Epoch complete 4, Loss: 7.3502
Epoch 5/69: 100% 386/386 [06:20<00:00,  1.01it/s, loss=7.13]
[2025-11-19 06:53:24] Epoch complete 5, Loss: 7.1348
Epoch 6/69: 100% 386/386 [06:20<00:00,  1.01it/s, loss=7.06]
[2025-11-19 06:59:45] Epoch complete 6, Loss: 7.0561
Epoch 7/69: 100% 386/386 [06:19<00:00,  1.02it/s, loss=6.92]
[2025-11-19 07:06:05] Epoch complete 7, Loss: 6.9228
Epoch 8/69: 100% 386/386 [06:18<00:00,  1.02it/s, loss=6.92]
[2025-11-19 07:12:23] Epoch complete 8, Loss: 6.9212
Epoch 9/69: 100% 386/386 [06:13<00:00,  1.03it/s, loss=6.81]
[2025-11-19 07:18:37] Epoch complete 9, Loss: 6.8071
[2025-11-19 07:18:37] Saving checkpoint at epoch 10; /content/drive/MyDrive/Colab Notebooks/7_Py_DL/FP/artifacts//moco_checkpoint_epoch_10.pth
Epoch 10/69: 100% 386/386 [06:14<00:00,  1.03it/s, loss=6.83]
[2025-11-19 07:24:52] Epoch complete 10, Loss: 6.8286
Epoch 11/69: 100% 386/386 [06:15<00:00,  1.03it/s, loss=6.76]
[2025-11-19 07:31:08] Epoch complete 11, Loss: 6.7625
Epoch 12/69: 100% 386/386 [06:15<00:00,  1.03it/s, loss=6.69]
[2025-11-19 07:37:23] Epoch complete 12, Loss: 6.6901
Epoch 13/69: 100% 386/386 [06:12<00:00,  1.04it/s, loss=6.64]
[2025-11-19 07:43:36] Epoch complete 13, Loss: 6.6444
Epoch 14/69: 100% 386/386 [06:19<00:00,  1.02it/s, loss=6.64]
[2025-11-19 07:49:55] Epoch complete 14, Loss: 6.6351
Epoch 15/69: 100% 386/386 [06:14<00:00,  1.03it/s, loss=6.63]
[2025-11-19 07:56:10] Epoch complete 15, Loss: 6.6304
Epoch 16/69: 100% 386/386 [06:16<00:00,  1.02it/s, loss=6.59]
[2025-11-19 08:02:27] Epoch complete 16, Loss: 6.5947
Epoch 17/69: 100% 386/386 [06:16<00:00,  1.03it/s, loss=6.55]
[2025-11-19 08:08:43] Epoch complete 17, Loss: 6.5542
Epoch 18/69: 100% 386/386 [06:12<00:00,  1.04it/s, loss=6.54]
[2025-11-19 08:14:56] Epoch complete 18, Loss: 6.5418
Epoch 19/69: 100% 386/386 [06:14<00:00,  1.03it/s, loss=6.5]
[2025-11-19 08:21:10] Epoch complete 19, Loss: 6.4992
[2025-11-19 08:21:10] Saving checkpoint at epoch 20; /content/drive/MyDrive/Colab Notebooks/7_Py_DL/FP/artifacts//moco_checkpoint_epoch_20.pth
Epoch 20/69: 100% 386/386 [06:18<00:00,  1.02it/s, loss=6.51]
[2025-11-19 08:27:30] Epoch complete 20, Loss: 6.5130
Epoch 21/69: 100% 386/386 [06:18<00:00,  1.02it/s, loss=6.49]
[2025-11-19 08:33:48] Epoch complete 21, Loss: 6.4871
Epoch 22/69: 100% 386/386 [06:18<00:00,  1.02it/s, loss=6.45]
[2025-11-19 08:40:06] Epoch complete 22, Loss: 6.4513
Epoch 23/69: 100% 386/386 [06:15<00:00,  1.03it/s, loss=6.45]
[2025-11-19 08:46:22] Epoch complete 23, Loss: 6.4480
Epoch 24/69: 100% 386/386 [06:12<00:00,  1.04it/s, loss=6.42]
[2025-11-19 08:52:34] Epoch complete 24, Loss: 6.4249
Epoch 25/69: 100% 386/386 [06:17<00:00,  1.02it/s, loss=6.43]
[2025-11-19 08:58:51] Epoch complete 25, Loss: 6.4311
Epoch 26/69: 100% 386/386 [06:12<00:00,  1.03it/s, loss=6.42]
[2025-11-19 09:05:04] Epoch complete 26, Loss: 6.4188
Epoch 27/69: 100% 386/386 [06:13<00:00,  1.03it/s, loss=6.42]
[2025-11-19 09:11:18] Epoch complete 27, Loss: 6.4152
Epoch 28/69: 100% 386/386 [06:17<00:00,  1.02it/s, loss=6.41]
[2025-11-19 09:17:36] Epoch complete 28, Loss: 6.4107
Epoch 29/69: 100% 386/386 [06:24<00:00,  1.00it/s, loss=6.4]
[2025-11-19 09:24:00] Epoch complete 29, Loss: 6.4004
[2025-11-19 09:24:00] Saving checkpoint at epoch 30; /content/drive/MyDrive/Colab Notebooks/7_Py_DL/FP/artifacts//moco_checkpoint_epoch_30.pth
Epoch 30/69: 100% 386/386 [06:26<00:00,  1.00s/it, loss=6.37]
[2025-11-19 09:30:28] Epoch complete 30, Loss: 6.3733
Epoch 31/69: 100% 386/386 [06:23<00:00,  1.01it/s, loss=6.38]
[2025-11-19 09:36:52] Epoch complete 31, Loss: 6.3806
Epoch 32/69: 100% 386/386 [06:25<00:00,  1.00it/s, loss=6.38]
[2025-11-19 09:43:18] Epoch complete 32, Loss: 6.3794
Epoch 33/69: 100% 386/386 [06:21<00:00,  1.01it/s, loss=6.36]
[2025-11-19 09:49:40] Epoch complete 33, Loss: 6.3634
Epoch 34/69: 100% 386/386 [06:14<00:00,  1.03it/s, loss=6.37]
[2025-11-19 09:55:54] Epoch complete 34, Loss: 6.3744
Epoch 35/69: 100% 386/386 [06:15<00:00,  1.03it/s, loss=6.36]
[2025-11-19 10:02:10] Epoch complete 35, Loss: 6.3562
Epoch 36/69: 100% 386/386 [06:12<00:00,  1.04it/s, loss=6.35]
[2025-11-19 10:08:22] Epoch complete 36, Loss: 6.3475
Epoch 37/69: 100% 386/386 [06:11<00:00,  1.04it/s, loss=6.34]
[2025-11-19 10:14:33] Epoch complete 37, Loss: 6.3385
Epoch 38/69: 100% 386/386 [06:19<00:00,  1.02it/s, loss=6.33]
[2025-11-19 10:20:53] Epoch complete 38, Loss: 6.3284
Epoch 39/69: 100% 386/386 [06:20<00:00,  1.01it/s, loss=6.34]
[2025-11-19 10:27:14] Epoch complete 39, Loss: 6.3392
[2025-11-19 10:27:14] Saving checkpoint at epoch 40; /content/drive/MyDrive/Colab Notebooks/7_Py_DL/FP/artifacts//moco_checkpoint_epoch_40.pth
Epoch 40/69: 100% 386/386 [06:21<00:00,  1.01it/s, loss=6.32]
[2025-11-19 10:33:36] Epoch complete 40, Loss: 6.3194
Epoch 41/69: 100% 386/386 [06:19<00:00,  1.02it/s, loss=6.32]
[2025-11-19 10:39:56] Epoch complete 41, Loss: 6.3195
Epoch 42/69: 100% 386/386 [06:23<00:00,  1.01it/s, loss=6.32]
[2025-11-19 10:46:19] Epoch complete 42, Loss: 6.3166
Epoch 43/69: 100% 386/386 [06:26<00:00,  1.00s/it, loss=6.3]
[2025-11-19 10:52:46] Epoch complete 43, Loss: 6.3034
Epoch 44/69: 100% 386/386 [06:12<00:00,  1.04it/s, loss=6.3]
[2025-11-19 10:58:58] Epoch complete 44, Loss: 6.2954
Epoch 45/69: 100% 386/386 [06:15<00:00,  1.03it/s, loss=6.31]
[2025-11-19 11:05:13] Epoch complete 45, Loss: 6.3119
Epoch 46/69: 100% 386/386 [06:15<00:00,  1.03it/s, loss=6.3]
[2025-11-19 11:11:28] Epoch complete 46, Loss: 6.2973
Epoch 47/69: 100% 386/386 [06:24<00:00,  1.00it/s, loss=6.3]
[2025-11-19 11:17:53] Epoch complete 47, Loss: 6.2987
Epoch 48/69: 100% 386/386 [06:24<00:00,  1.01it/s, loss=6.3]
[2025-11-19 11:24:17] Epoch complete 48, Loss: 6.3020
Epoch 49/69: 100% 386/386 [06:23<00:00,  1.01it/s, loss=6.28]
[2025-11-19 11:30:41] Epoch complete 49, Loss: 6.2840
[2025-11-19 11:30:41] Saving checkpoint at epoch 50; /content/drive/MyDrive/Colab Notebooks/7_Py_DL/FP/artifacts//moco_checkpoint_epoch_50.pth
Epoch 50/69: 100% 386/386 [06:25<00:00,  1.00it/s, loss=6.28]
[2025-11-19 11:37:07] Epoch complete 50, Loss: 6.2798
Epoch 51/69: 100% 386/386 [06:26<00:00,  1.00s/it, loss=6.28]
[2025-11-19 11:43:33] Epoch complete 51, Loss: 6.2849
Epoch 52/69: 100% 386/386 [06:24<00:00,  1.00it/s, loss=6.29]
[2025-11-19 11:49:58] Epoch complete 52, Loss: 6.2873
Epoch 53/69: 100% 386/386 [06:25<00:00,  1.00it/s, loss=6.29]
[2025-11-19 11:56:24] Epoch complete 53, Loss: 6.2928
Epoch 54/69: 100% 386/386 [06:27<00:00,  1.00s/it, loss=6.27]
[2025-11-19 12:02:51] Epoch complete 54, Loss: 6.2718
Epoch 55/69: 100% 386/386 [06:23<00:00,  1.01it/s, loss=6.3]
[2025-11-19 12:09:15] Epoch complete 55, Loss: 6.2987
Epoch 56/69: 100% 386/386 [06:28<00:00,  1.01s/it, loss=6.28]
[2025-11-19 12:15:43] Epoch complete 56, Loss: 6.2830
Epoch 57/69: 100% 386/386 [06:28<00:00,  1.01s/it, loss=6.3]
[2025-11-19 12:22:11] Epoch complete 57, Loss: 6.2995
Epoch 58/69: 100% 386/386 [06:25<00:00,  1.00it/s, loss=6.28]
[2025-11-19 12:28:37] Epoch complete 58, Loss: 6.2845
Epoch 59/69: 100% 386/386 [06:23<00:00,  1.01it/s, loss=6.27]
[2025-11-19 12:35:01] Epoch complete 59, Loss: 6.2740
[2025-11-19 12:35:01] Saving checkpoint at epoch 60; /content/drive/MyDrive/Colab Notebooks/7_Py_DL/FP/artifacts//moco_checkpoint_epoch_60.pth
Epoch 60/69: 100% 386/386 [06:25<00:00,  1.00it/s, loss=6.28]
[2025-11-19 12:41:27] Epoch complete 60, Loss: 6.2759
Epoch 61/69: 100% 386/386 [06:30<00:00,  1.01s/it, loss=6.27]
[2025-11-19 12:47:58] Epoch complete 61, Loss: 6.2673
Epoch 62/69: 100% 386/386 [06:26<00:00,  1.00s/it, loss=6.26]
[2025-11-19 12:54:24] Epoch complete 62, Loss: 6.2623
Epoch 63/69: 100% 386/386 [06:28<00:00,  1.01s/it, loss=6.27]
[2025-11-19 13:00:52] Epoch complete 63, Loss: 6.2703
Epoch 64/69: 100% 386/386 [06:25<00:00,  1.00it/s, loss=6.27]
[2025-11-19 13:07:18] Epoch complete 64, Loss: 6.2712
Epoch 65/69: 100% 386/386 [06:23<00:00,  1.01it/s, loss=6.26]
[2025-11-19 13:13:41] Epoch complete 65, Loss: 6.2646
Epoch 66/69: 100% 386/386 [06:21<00:00,  1.01it/s, loss=6.27]
[2025-11-19 13:20:03] Epoch complete 66, Loss: 6.2724
Epoch 67/69: 100% 386/386 [06:27<00:00,  1.00s/it, loss=6.28]
[2025-11-19 13:26:31] Epoch complete 67, Loss: 6.2798
Epoch 68/69: 100% 386/386 [06:24<00:00,  1.00it/s, loss=6.3]
[2025-11-19 13:32:55] Epoch complete 68, Loss: 6.2981
Epoch 69/69: 100% 386/386 [06:30<00:00,  1.01s/it, loss=6.37]
[2025-11-19 13:39:26] Epoch complete 69, Loss: 6.3671
[2025-11-19 13:39:26] Saving checkpoint at epoch 70; /content/drive/MyDrive/Colab Notebooks/7_Py_DL/FP/artifacts//moco_checkpoint_epoch_70.pth
[2025-11-19 13:39:27] MoCo training complete!!
[2025-11-19 13:39:27] Saved pretrained encoder to /content/drive/MyDrive/Colab Notebooks/7_Py_DL/FP/artifacts/moco_resnet50_encoder.pth
[2025-11-19 13:39:27] Saved training stats to /content/drive/MyDrive/Colab Notebooks/7_Py_DL/FP/artifacts//pretrain_stats_training.json
[2025-11-19 13:39:27] Starting MoCo backbone testing...
Loading train dataset...
CSV: /content/drive/MyDrive/Colab Notebooks/7_Py_DL/FP/Data/2_final_project_updated_names_train_linear.csv
 * Images - Train Root Directory: /tmp/CheXpert_dataset/CheXpert_reduced_dataset_split_v3/train
Unique labels in column 'Pneumonia': [1 0]
Loading test dataset...
CSV: /content/drive/MyDrive/Colab Notebooks/7_Py_DL/FP/Data/2_final_project_updated_names_test_linear.csv
 * Images - Test Root Directory: /tmp/CheXpert_dataset/CheXpert_reduced_dataset_split_v3/test
Unique labels in column 'Pneumonia': [1 0]
[2025-11-19 13:39:34] Starting MoCo backbone testing...
[2025-11-19 13:39:34] Starting linear evaluation for 10 epochs...
[2025-11-19 13:40:11] Epoch 1/10, Test Acc: 17.77%
[2025-11-19 13:40:48] Epoch 2/10, Test Acc: 21.06%
[2025-11-19 13:41:25] Epoch 3/10, Test Acc: 67.11%
[2025-11-19 13:42:02] Epoch 4/10, Test Acc: 79.71%
[2025-11-19 13:42:38] Epoch 5/10, Test Acc: 82.14%
[2025-11-19 13:43:15] Epoch 6/10, Test Acc: 17.80%
[2025-11-19 13:43:52] Epoch 7/10, Test Acc: 79.27%
[2025-11-19 13:44:29] Epoch 8/10, Test Acc: 17.77%
[2025-11-19 13:45:06] Epoch 9/10, Test Acc: 82.23%
[2025-11-19 13:45:42] Epoch 10/10, Test Acc: 82.23%
[2025-11-19 13:45:42] MoCo backbone testing complete!
[2025-11-19 13:45:42] MoCo backbone testing complete!!
[2025-11-19 13:45:42] Saved testing stats to /content/drive/MyDrive/Colab Notebooks/7_Py_DL/FP/artifacts//test_stats.json